<div class="modal-container">
  <div class="header-p">
    <div class="company-header-group">
      <img *ngIf="companyInfo?.logoUrl" [src]="getImgUrl(companyInfo?.logoUrl)" class="dialog-logo" alt="Logo">
      <div class="company-text">
        <h1>{{companyInfo?.name || 'ELECTRIC INVENTORY'}}</h1>
        <div class="meta-row" *ngIf="companyInfo?.address">
          {{companyInfo?.address?.addressLine1}}, {{companyInfo?.address?.city}} - {{companyInfo?.address?.pinCode}}
        </div>
        <div class="meta-row">
          Ph: {{companyInfo?.primaryPhone}} | {{companyInfo?.primaryEmail}}
        </div>
      </div>
    </div>

    <div class="doc-title-group">
      <h2>CREDIT NOTE #{{data.returnNumber}}</h2>
      <span class="date-text">{{data.returnDate | date:'dd MMM yyyy'}}</span>
    </div>
  </div>

  <div class="info-grid">
    <div class="info-item">
      <span class="label">Customer Name</span>
      <span class="value">{{data.customerName || 'Processing...'}}</span>
    </div>
    <div class="info-item">
      <span class="label">Sales Order Reference</span>
      <span class="value">{{data.soNumber || 'N/A'}}</span>
    </div>
  </div>

  <div class="table-responsive">
    <table class="items-table">
      <thead>
        <tr>
          <th>Product Name</th>
          <th style="text-align: center;">Qty</th>
          <th style="text-align: right;">Rate</th>
          <th style="text-align: center;">Tax%</th>
          <th style="text-align: right;">Total</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of data.items">
          <td>{{item.productName}}</td>
          <td style="text-align: center;">{{item.qty | number:'1.2-2'}}</td>
          <td style="text-align: right;">{{item.rate | currency:'INR':'symbol':'1.2-2'}}</td>
          <td style="text-align: center;">{{item.taxPercent}}%</td>
          <td style="text-align: right;">{{item.total | currency:'INR':'symbol':'1.2-2'}}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="footer-container">
    <div class="summary-card">
      <div class="summary-line">
        <span>Sub-Total:</span>
        <span>{{data.subTotal | currency:'INR'}}</span>
      </div>
      <div class="summary-line">
        <span>Total Tax:</span>
        <span>{{data.totalTax | currency:'INR'}}</span>
      </div>
      <div class="total-line">
        <span>Grand Total:</span>
        <span>{{data.grandTotal | currency:'INR'}}</span>
      </div>
    </div>
  </div>

  <mat-dialog-actions align="end">
    <button mat-raised-button (click)="onClose()">Close</button>
    <button mat-raised-button color="primary" (click)="print()">
      <mat-icon>print</mat-icon> Print
    </button>
  </mat-dialog-actions>
</div>