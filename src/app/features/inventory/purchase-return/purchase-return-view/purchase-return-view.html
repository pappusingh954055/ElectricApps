<div class="dialog-container">
  
  <!-- Header -->
  <div class="header-p">
    <div class="company-header-group">
      <img *ngIf="companyInfo?.logoUrl" [src]="getImgUrl(companyInfo?.logoUrl)" class="dialog-logo" alt="Logo">
      <div class="company-text">
        <h1>{{companyInfo?.name || 'ELECTRIC INVENTORY'}}</h1>
        <div class="meta-row" *ngIf="companyInfo?.address">
          {{companyInfo?.address?.addressLine1}}, {{companyInfo?.address?.city}} - {{companyInfo?.address?.pinCode}}
        </div>
        <div class="meta-row">
          Ph: {{companyInfo?.primaryPhone}} | {{companyInfo?.primaryEmail}}
        </div>
      </div>
    </div>

    <div class="order-title-group">
      <h2>RETURN #{{data.returnNumber}}</h2>
      <span class="status-pill fail" *ngIf="data.status === 'Draft'">{{data.status}}</span>
      <span class="status-pill success" *ngIf="data.status === 'Completed' || data.status === 'Confirmed'">{{data.status}}</span>
    </div>

    <button mat-icon-button mat-dialog-close class="close-btn">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <!-- Scrollable Content -->
  <div mat-dialog-content class="content-body">
    
    <!-- Info Grid -->
    <div class="info-card">
      <div class="info-group">
        <label>Supplier Name</label>
        <div class="value">{{data.supplierName}}</div>
      </div>
      <div class="info-group">
        <label>Return Date</label>
        <div class="value">{{data.returnDate | date:'dd MMM yyyy'}}</div>
      </div>
      <div class="info-group">
        <label>Status</label>
        <div class="value status-badge" 
             [ngClass]="{
               'completed': data?.status === 'Completed' || data?.status === 'Confirmed'
             }">
          {{ data?.status }}
        </div>
      </div>
      <div class="info-group">
        <label>GRN Reference</label>
        <div class="value">{{data.items[0]?.grnRef || 'N/A'}}</div>
      </div>
    </div>

    <!-- Items Table -->
    <div class="items-table-container">
      <table class="items-table">
        <thead>
          <tr>
            <th class="col-product">Product Description</th>
            <th class="col-qty text-center">Return Qty</th>
            <th class="col-rate text-end">Rate</th>
            <th class="col-disc text-center">Disc (%)</th>
            <th class="col-tax text-center">Tax (%)</th>
            <th class="col-total text-end">Total</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of data.items">
            <td>{{item.productName}}</td>
            <td class="text-center">{{item.returnQty}}</td>
            <td class="text-end">{{item.rate | currency:'INR':'symbol':'1.2-2'}}</td>
            <td class="text-center">{{item.discountPercent}}%</td>
            <td class="text-center">{{item.gstPercent}}%</td>
            <td class="text-end">{{item.totalAmount | currency:'INR':'symbol':'1.2-2'}}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Summary Section -->
    <div class="invoice-summary">
        <div class="summary-row">
            <span class="label">Sub Total</span>
            <span class="value">{{(data.subTotal || 0) | currency:'INR':'symbol':'1.2-2'}}</span>
        </div>
        <div class="summary-row">
            <span class="label">Total Tax</span>
            <span class="value">{{(data.taxAmount || 0) | currency:'INR':'symbol':'1.2-2'}}</span>
        </div>
        <div class="summary-row grand-total">
            <span class="label">Grand Total</span>
            <span class="value">{{(data.grandTotal || 0) | currency:'INR':'symbol':'1.2-2'}}</span>
        </div>
    </div>

  </div>

  <!-- Footer Actions -->
  <div mat-dialog-actions class="dialog-actions">
    <button mat-stroked-button mat-dialog-close color="warn">Close</button>
    <button mat-flat-button color="primary" (click)="print()">
      <mat-icon>print</mat-icon> Print Details
    </button>
  </div>

</div>