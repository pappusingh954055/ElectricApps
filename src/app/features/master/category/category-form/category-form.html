<mat-card>
  <div style="display: flex; justify-content: space-between; align-items: center; padding-right: 16px;">
    <mat-card-title>{{ categoryId ? 'Edit' : 'Add' }} Category</mat-card-title>
    
    <div style="display: flex; align-items: center; gap: 12px;">
      <span *ngIf="selectedFileName" style="font-size: 0.9em; color: #666;">
        {{ selectedFileName }}
      </span>
      
      <button mat-stroked-button color="primary" (click)="downloadTemplate()">
        <mat-icon>download</mat-icon> Download Template
      </button>

      <button mat-stroked-button color="primary" (click)="fileInput.click()">
        <mat-icon>cloud_upload</mat-icon> Upload Excel
      </button>

      <input #fileInput type="file" (change)="onFileSelected($event)" style="display: none;" accept=".xlsx, .xls">

      <button mat-raised-button class="submit-btn" *ngIf="selectedFileName" (click)="uploadExcel()">
        <mat-icon>save</mat-icon> Save
      </button>

      <button mat-icon-button class="cancel-btn" *ngIf="selectedFileName" (click)="resetFile(fileInput)" matTooltip="Reset File">
        <mat-icon>close</mat-icon>
      </button>
      <button mat-raised-button class="submit-btn" *ngIf="!selectedFileName" (click)="onSave()" [disabled]="loading">
        <mat-icon>save</mat-icon> {{ categoryId ? 'Update' : 'Save' }}
      </button>

      <button mat-raised-button class="cancel-btn" (click)="onCancel()" *ngIf="!selectedFileName">
        <mat-icon>close</mat-icon> Cancel
      </button>
    </div>
  </div>

  <mat-card-content *ngIf="!selectedFileName">
    <form [formGroup]="categoryForm" class="form-grid">

       <mat-form-field appearance="outline">
        <mat-label>Category Code</mat-label>
        <input matInput formControlName="categoryCode">
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Category Name *</mat-label>
        <input matInput formControlName="categoryName">
        <mat-error *ngIf="categoryForm.get('categoryName')?.hasError('required')">
          Category Name is required
        </mat-error>
      </mat-form-field>

     

      <mat-form-field appearance="outline">
        <mat-label>Default GST %</mat-label>
        <input matInput type="number" formControlName="defaultGst">
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Description</mat-label>
        <textarea matInput rows="1" formControlName="description"></textarea>
      </mat-form-field>

      <mat-slide-toggle formControlName="isActive">
        Active
      </mat-slide-toggle>

    </form>
  </mat-card-content>

</mat-card>